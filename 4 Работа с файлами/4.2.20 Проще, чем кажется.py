# –ü—Ä–æ—â–µ, —á–µ–º –∫–∞–∂–µ—Ç—Å—è üå∂Ô∏è
# –†–∞—Å—Å–º–æ—Ç—Ä–∏–º —Å–ª–µ–¥—É—é—â–∏–π —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç:
#
# ball,color,purple
# ball,size,4
# ball,notes,it's round
# cup,color,blue
# cup,size,1
# cup,notes,none
# –ö–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ —ç—Ç–æ–≥–æ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç—Ä–∏ –∑–Ω–∞—á–µ–Ω–∏—è —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é: –∏–º—è –æ–±—ä–µ–∫—Ç–∞, —Å–≤–æ–π—Å—Ç–≤–æ —ç—Ç–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞, –∑–Ω–∞—á–µ–Ω–∏–µ
# —Å–≤–æ–π—Å—Ç–≤–∞. –ù–∞–ø—Ä–∏–º–µ—Ä, –≤ –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–µ —É–∫–∞–∑–∞–Ω –æ–±—ä–µ–∫—Ç ball, –∏–º–µ—é—â–∏–π —Å–≤–æ–π—Å—Ç–≤–æ color, –∑–Ω–∞—á–µ–Ω–∏–µ –∫–æ—Ç–æ—Ä–æ–≥–æ —Ä–∞–≤–Ω–æ purple. –¢–∞–∫–∂–µ
# —É –æ–±—ä–µ–∫—Ç–∞ ball –µ—Å—Ç—å —Å–≤–æ–π—Å—Ç–≤–∞ size –∏ notes, –∏–º–µ—é—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è 4 –∏ it's round —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ. –ü–æ–º–∏–º–æ –æ–±—ä–µ–∫—Ç–∞ ball
# –∏–º–µ–µ—Ç—Å—è –æ–±—ä–µ–∫—Ç cup, –∏–º–µ—é—â–∏–π —Ç–µ –∂–µ —Å–≤–æ–π—Å—Ç–≤–∞ –∏ –≤ —Ç–æ–º –∂–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ. –î–∞–¥–∏–º —ç—Ç–∏–º –æ–±—ä–µ–∫—Ç–∞–º –æ–±—â–µ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ object –∏
# —Å–≥—Ä—É–ø–ø–∏—Ä—É–µ–º —Å—Ç—Ä–æ–∫–∏ –¥–∞–Ω–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞ –ø–æ –ø–µ—Ä–≤–æ–º—É —Å—Ç–æ–ª–±—Ü—É:
#
# object,color,size,notes
# ball,purple,4,it's round
# cup,blue,1,none
# –ú—ã –ø–æ–ª—É—á–∏–ª–∏ –∑–∞–ø–∏—Å—å –≤ –ø—Ä–∏–≤—ã—á–Ω–æ–º CSV —Ñ–æ—Ä–º–∞—Ç–µ, –≤ –∫–æ—Ç–æ—Ä–æ–º –≤ –ø–µ—Ä–≤–æ–º —Å—Ç–æ–ª–±—Ü–µ —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∏–º—è –æ–±—ä–µ–∫—Ç–∞, –∞ –≤ –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö ‚Äî
# –∑–Ω–∞—á–µ–Ω–∏—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö —Å–≤–æ–π—Å—Ç–≤ —ç—Ç–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞.
#
# –†–µ–∞–ª–∏–∑—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é condense_csv(), –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –¥–≤–∞ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–º —Ñ–æ—Ä–º–∞—Ç–µ:
#
# filename ‚Äî –Ω–∞–∑–≤–∞–Ω–∏–µ csv —Ñ–∞–π–ª–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä, data.csv; —Ñ–æ—Ä–º–∞—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ —Ñ–∞–π–ª–∞ –∞–Ω–∞–ª–æ–≥–∏—á–µ–Ω —Ñ–æ—Ä–º–∞—Ç—É —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞,
# —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–Ω–æ–≥–æ –≤ —É—Å–ª–æ–≤–∏–∏ –∑–∞–¥–∞—á–∏: –∫–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ —Ñ–∞–π–ª–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç—Ä–∏ –∑–Ω–∞—á–µ–Ω–∏—è —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é, –∞ –∏–º–µ–Ω–Ω–æ –∏–º—è –æ–±—ä–µ–∫—Ç–∞,
# —Å–≤–æ–π—Å—Ç–≤–æ —ç—Ç–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞, –∑–Ω–∞—á–µ–Ω–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞; –≤—Å–µ –æ–±—ä–µ–∫—Ç—ã –∏–º–µ—é—Ç —Ä–∞–≤–Ω—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞ –∏ –≤ —Ä–∞–≤–Ω—ã—Ö –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞—Ö
# id_name ‚Äî –æ–±—â–µ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –¥–ª—è –æ–±—ä–µ–∫—Ç–æ–≤
# –§—É–Ω–∫—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –ø—Ä–∏–≤–µ—Å—Ç–∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ –≤ –ø—Ä–∏–≤—ã—á–Ω—ã–π CSV —Ñ–æ—Ä–º–∞—Ç, —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–≤ —Å—Ç—Ä–æ–∫–∏ –ø–æ –ø–µ—Ä–≤–æ–º—É —Å—Ç–æ–ª–±—Ü—É –∏ –Ω–∞–∑–≤–∞–≤
# –ø–µ—Ä–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü id_name. –ü–æ–ª—É—á–µ–Ω–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ñ—É–Ω–∫—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –∑–∞–ø–∏—Å–∞—Ç—å –≤ —Ñ–∞–π–ª condensed.csv.

import csv


def condense_csv(filename, id_name):
    dct = {}
    with open(filename, encoding='utf-8') as file_in:
        data = csv.reader(file_in)
        columns = [id_name]
        for row in data:
            if row[1] not in columns:
                columns.append(row[1])
            dct.setdefault(row[0], []).append(row[2])

        with open('condensed.csv', 'w', encoding='utf-8', newline='') as file_out:
            writer = csv.writer(file_out)
            writer.writerow(columns)
            for i, v in dct.items():
                writer.writerow([i] + v)
